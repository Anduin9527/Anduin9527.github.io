---
title: 计算机组成原理笔记（五）
tags:
  - 笔记
  - 硬件
category: 计算机组成原理
katex: true
abbrlink: fe0a25d8
date: 2022-07-26 15:53:07
---

## 前言

难起来了，光看哈工大的 mooc 感觉已经听不懂了，准备去啃啃 CSAPP 或者 Nand2Tetris 。

<!--more-->

## 概述

### 输入输出系统的发展概况

早期的计算机数目较少，应用少，外设也少。所以早期使用 **分散连接** 的方式，即每一个设备都有专门的控制电路，甚至与 CPU 的控制电路高度耦合。所以对外设增删都非常麻烦。外部设备与主机的连接主要采用 **程序查询方式**，即 CPU 和 I/O 设备 **串行工作**。

随着计算机发展，分散连接逐步被淘汰。出现了 **I/O 接口** 与 **DMA 控制器**，采用 **总线** 方式进行连接，一条总线连接多个设备，总线与 I/O 设备的传输方式也变成了 **并行工作**。

为了进一步使得 I/O 操作独立于 CPU 之外，又出现了具有 **通道结构** 的 I/O，可以看成 **小型的 DMA 控制器**，具有自己的指令系统，可以控制连接在通道上的 I/O 设备直接与主机交互。

现代的超级计算机可以使用专门的处理器作为 I/O 处理机，甚至能帮助 CPU 进行运算。

### 输入输出系统的组成

**I/O 软件**

1. I/O 指令：CPU 指令集的一部分，其格式为操作码+命令码+设备码
2. 通道指令：通道能够指令由通道指令构成的程序，指出数组的首地址、传送字数、操作命令

**I/O 硬件**

1. 设备–I/O 接口–总线–主机
2. 设备–设备控制器–子通道–通道–主机

### I/O 设备与主机的联系方式

I/O 设备是有地址的，主机必须要给出其地址才能操作。所以要对 I/O 设备编址，其编址方式有：

**统一编址**：将 I/O 设备地址编写在内存区域，用取数和读数到对应区域则为 I/O 操作。显然会节省命令集，但是对于寻址空间的要求较高。

**单独编址**：在内存地址之外，专门设置一个地址空间给外部设备。为了区分指令是对内存还是对 I/O 设备，此时需要有专门的 I/O 指令进行操作。

编址之后，需要选址。采用 **设备选择电路** 识别是否被选中，只要把 CPU 给出的地址和设备中保存的地址进行比较，相同则为选中。然后就可以开始数据传送：

**串行**：数据一位一位进行传输，传输速度慢，适合远程上传输

**并行**：同时有多位数据进行传输，通常情况下为 8 的倍数。

联络方式：外设接受或发送数据的响应情况

**立即响应**：直接发生响应

**异步工作**：一般采用应答信号的方式，分为并行传输和串行传输。

<img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/%E4%B8%80%E8%88%AC%E9%87%87%E7%94%A8%E5%BA%94%E7%AD%94%E4%BF%A1%E5%8F%B7%E7%9A%84%E6%96%B9%E5%BC%8F.png" alt="image-20220724133812663" style="zoom:80%;" />

**同步工作**：采用同步时标

### I/O 设备与主机信息传送的控制方式

程序查询方式：CPU 和外设串行工作

程序中断方式：CPU 和外设做到部分并行

DMA 方式：使得外部设备和内存之间建立直接连接，无需 CPU 额外处理

<img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/%E7%A8%8B%E5%BA%8F%E6%9F%A5%E8%AF%A2%E6%96%B9%E5%BC%8F.png" alt="image-20220724135731680" style="zoom:80%;" />

<img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%96%AD.png" alt="image-20220724140401331" style="zoom:80%;" />

<img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%96%AD2.png" alt="image-20220724140459014" style="zoom:80%;" />

<img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/DMAa.png" alt="image-20220724141208316" style="zoom:80%;" />



## 外部设备

### 概述

外部设备（I/O 设备）通过 I/O 接口与主机相连，其主要包含两个部分：设备控制器与物理部分。

<img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/%E5%A4%96%E9%83%A8%E8%AE%BE%E5%A4%87.png" alt="image-20220725101402068" style="zoom:80%;" />

### 外部设备的分类

1. 人机交互设备：键盘、鼠标、打印机、显示器
2. 计算机信息存储设备：磁盘、光盘、磁带
3. 机-机通信设备：调制解调器

## I/O 接口

### 接口的功能

1. 实现设备的选择
2. 实现数据的缓冲平衡不同外部设备速度匹配
3. 实现数据串-并格式转换
4. 实现电平转换
5. 传送控制命令
6. 反映设备的工作状态。

### 接口的组成

<img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/%E6%8E%A5%E5%8F%A3%E7%9A%84%E7%BB%84%E6%88%90.png" alt="image-20220725103240038" style="zoom:80%;" />

+ 设备选择线（单向）：传送本次参与信息传输的设备码（设备地址）或端口地址给 I/O 接口进行匹配
+ 数据线（双向）：完成数据的输入输出
+ 命令线（单向）：主机发送命令进过缓冲和译码之后，控制设备操作
+ 状态线（单向）：从 I/O 接口发送给主机，告知设备的状态

### 接口的功能和组成

| 功能         | 组成                   |
| ------------ | ---------------------- |
| 选址功能     | 设备选择电路           |
| 传送命令     | 命令寄存器、命令译码器 |
| 传送数据     | 数据缓冲寄存器         |
| 反映设备状态 | 设备状态标记           |

<img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/I/O%E6%8E%A5%E5%8F%A3%E7%BB%84%E6%88%90.png" alt="image-20220725104935351" style="zoom:80%;" />

### 接口分类

1. 数据传送方式分类：并行接口、串行接口
2. 选择的灵活性分类：可编程接口、不可编程接口
3. 通用性分类：通用接口、专用接口
4. 数据传送的控制方式：中断方式接口、DMA 接口
