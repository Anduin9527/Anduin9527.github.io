---
title: 浅谈贝叶斯定理
tags:
  - 数学
abbrlink: 8fd34f7b
katex: true
date: 2022-02-28 19:03:59
---

### 前言

恍恍惚惚，大二下开始学习概率论了，G！

![95841206_p0](https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20220228195301.jpg)

<!--more-->

### 引例

上完了九年义务制教育的朋友们大多知道什么叫概率，再不济也知道古典概型无非就是从有限的盒子里等可能地去摸球。概率嘛，无非就是可能除以总数（X）。好，那让我们来看看下面这个问题：

>假设某种疾病在所有人群中的感染率是1%，医院现有的技术对于该疾病检测的灵敏度(Sensitivity)为90%，这意味着100个确诊的人中有10名将会是误诊的。而技术的特异度（Specificity）为91%，这意味着100名健康的人群中会有9人误诊。
>
>好的，现在请思考一下，假设我们对1000名人员进行该医学检测，而你不幸被检测为阳性（患病），请问你患病的几率大概是多少呢？

A.  $9\over 10$	B.$8\over10$	C.$1\over 10$	D.$1\over 100$



**答案在分割线下！！！**

---



嘿嘿，答案是**C**。

真是奇怪，明明这么高的灵敏度，为什么患病的几率反而如此之低ne？这其实就是一种反直觉的现象。现在让我们一起算一下这题。

1000个人中的感染率为1%，也就是有10个人是真正的患者，检测的灵敏度为90%，换言之误诊率为10%。这意味着我们会检测出其中的9名真正的患者和1名误诊的。而91%的特异度将会为我们带来
$$
(1000-10)*(1-91\%)\approx89
$$
89名误诊！接着用我们都会的条件概率进行简单地计算
$$
P(confirm\,Patient|Patient)=\tfrac{9}{9+89}=0.091
$$
不到十分之一的概率为真正的患者，That's so ridiculous。其实不难发现，这里的假阳性比阳性的还要多。

### “谬”

这里引用$3b1b$大佬的话，我们算出的概率并不能体现你患病的几率，正确的观点是我们算出的概率**更新**了你患病的几率。

这里就可以引出先验概率的概念

> 先验概率（prior probability）是指根据以往经验和分析得到的概率，如全概率公式，它往往作为"由因求果"问题中的"因"出现的概率。

显然，原本的先验概率为人群中的感染率也就是1%。而检测的值**更新**了这一概率，将概率增加了一个数量级。但这并不是我们想要的答案。在本题中我们只关心检测出为阳性时的情况倾向。
$$
\tfrac{Sensitivity}{1-Specificity}=10
$$
这就是似然比(likelihood ratio)，也叫做贝叶斯因子。这里有个著名的经验公式，贝叶斯推断。用于更新**较小的先验概率**。在本例中，先验概率为1%，乘以贝叶斯因子后结果为 0.1 接近了正确答案 0.091。

再举个例子，将上面的条件由1000人换到100人，患病率由1%换成10%。这意味着我们将有10名确诊（9名真患者，1名误诊），90名正常（8人逃脱，81名正常）。但是我们的似然比保持不变为10。
$$
P(confirm\,Patient|Patient)=\tfrac{9}{9+8}\approx 53\%
$$
显然在先验概率过大的情况下随意使用经验公式，会出问题。但事实上，之所以只能在较小的先验概率中使用，是因为他的原型为更新比率而非更新概率。比如50%的概率，他的比率为 1:1。所以真正的贝叶斯公式，**是将先验概率以比率的形式被贝叶斯因子更新。**

回到最开始的条件，先验概率为 1%，比率形式为 1:99，然后用贝叶斯因子更新为 10:99 也就是 10/109 的概率，与我们计算的答案别无二致。

同样的，当先验概率为10%，比率形式为 1:9 ，更新后为 10:9 也就是 10/19 的概率，正好是 53%。

回到，我们一开始的问题。给予人们这种错觉的原因往往是条件概率的认知不清。当我们在说准确率为99%准确性的测试的时候，表示的是 **已知一个人得病(B)的情况下检测出阳性(A)的概率**。即 $P(A|B)$，而人人往往将其等同于 **一个人在检测出阳性(A)的情况下得病(B)的概率**。即$P(B|A)$。那么，有没有一种………

### 贝叶斯

贝叶斯是一种已知结果B反求因A的思想。下面举个例子：

<div>graph TB
A1(A1)-->B(B)
A2(A2)-->B(B)
A3(A3)-->B(B)
</div>

显然这里有三条路径来完成整件事情，对于第一条路径 A1->B 而言：
$$
P_1=P(A1)*P(B|A1)
$$
同样的，我们可以得到 $P2$ 和 $P3$ ，而他们的求和正好就是B的全概率公式，也是贝叶斯公式的分母。

那么现在我们求的**因**，也就是其中一条路径在全部路径中的概率，问题就是一个简单的**类古典概型**了。

给出我们的通式：
$$
P(A|B)=\frac{P(B|A)*P(A)}{P(B|A)*P(A)+P(B|A^c)*P(A^c)}
$$

+ 这里的$A^c$是A的对立事件
+ 分母为$P(B)$的全概率公式

### 参考

[Think Bayes](https://zhuanlan.zhihu.com/p/22467549)

[The medical test paradox, and redesigning Bayes' rule](https://www.youtube.com/watch?v=lG4VkPoG3ko)
