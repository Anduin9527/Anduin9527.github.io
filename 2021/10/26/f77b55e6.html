<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#66d6ff"><meta name="author" content="Anduin9527"><meta name="copyright" content="Anduin9527"><meta name="generator" content="Hexo 6.2.0"><meta name="theme" content="hexo-theme-yun"><title>微软三件套安装以及配置 | Anduin9527的乖离器</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.3.3/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/images/favicon.svg"><link rel="mask-icon" href="/images/favicon.svg" color="#66d6ff"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"lapras.xyz","root":"/","title":["拉普","拉斯~","的","乖离器"],"version":"1.10.6","mode":"time","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","fireworks":{"colors":["#00D1CE","#66D6FF","#919191"]},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="alternate" href="/atom.xml" title="Anduin9527的乖离器" type="application/atom+xml"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap"><script src="/h" async></script><script src="/t" async></script><script src="/t" async></script><script src="/p" async></script><script src="/s" async></script><script src="/:" async></script><script src="/" async></script><script src="/" async></script><script src="/c" async></script><script src="/d" async></script><script src="/n" async></script><script src="/." async></script><script src="/j" async></script><script src="/s" async></script><script src="/d" async></script><script src="/e" async></script><script src="/l" async></script><script src="/i" async></script><script src="/v" async></script><script src="/r" async></script><script src="/." async></script><script src="/n" async></script><script src="/e" async></script><script src="/t" async></script><script src="/" async></script><script src="/n" async></script><script src="/p" async></script><script src="/m" async></script><script src="/" async></script><script src="/i" async></script><script src="/o" async></script><script src="/n" async></script><script src="/i" async></script><script src="/c" async></script><script src="/o" async></script><script src="/n" async></script><script src="/s" async></script><script src="/" async></script><script src="/d" async></script><script src="/i" async></script><script src="/s" async></script><script src="/t" async></script><script src="/" async></script><script src="/i" async></script><script src="/o" async></script><script src="/n" async></script><script src="/i" async></script><script src="/c" async></script><script src="/o" async></script><script src="/n" async></script><script src="/s" async></script><script src="/." async></script><script src="/j" async></script><script src="/s" async></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-NSLVQ2H5JH"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-NSLVQ2H5JH');
}</script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><meta property="og:type" content="article">
<meta property="og:title" content="微软三件套安装以及配置">
<meta property="og:url" content="http://lapras.xyz/2021/10/26/f77b55e6.html">
<meta property="og:site_name" content="Anduin9527的乖离器">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20211026174036.jpg">
<meta property="og:image" content="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20211026175219.png">
<meta property="og:image" content="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20211026180656.png">
<meta property="og:image" content="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20211026180900.png">
<meta property="og:image" content="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20211026184621.png">
<meta property="article:published_time" content="2021-10-26T09:27:59.000Z">
<meta property="article:modified_time" content="2022-08-21T07:21:56.325Z">
<meta property="article:author" content="Anduin9527">
<meta property="article:tag" content="工具">
<meta property="article:tag" content="分享">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20211026174036.jpg"><script type="module">import { getScript } from '/js/utils.js'
getScript("https://fastly.jsdelivr.net/npm/mermaid/dist/mermaid.min.js", () => {
  const mermaidOptions = {"startOnload":true}
  mermaid.initialize(mermaidOptions);
}, window.mermaid);
</script><style>.mermaid{background: transparent;}</style><script>(function() {
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Anduin9527"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Anduin9527"><span class="site-author-status" title="建模建模呜呜呜！">😭</span></a><div class="site-author-name"><a href="/about/">Anduin9527</a></div><span class="site-name">Anduin9527的乖离器</span><sub class="site-subtitle">正在进修摸鱼学导论</sub><div class="site-description">南邮摸鱼ing</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">45</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">10</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">30</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="tencent://message/?uin=2676057183&amp;Site=&amp;Menu=yes" title="QQ" target="_blank" style="color:#12B7F5"><span class="icon iconify" data-icon="ri:qq-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/Anduin9527" title="GitHub" target="_blank" style="color:#181717"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:2676057183@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=579015212" title="网易云音乐" target="_blank" style="color:#C10D0C"><span class="icon iconify" data-icon="ri:netease-cloud-music-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/chu-liu-16-64" title="知乎" target="_blank" style="color:#0084FF"><span class="icon iconify" data-icon="ri:zhihu-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/21994551" title="哔哩哔哩动画" target="_blank" style="color:#FF8EB3"><span class="icon iconify" data-icon="ri:bilibili-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><span class="icon iconify" data-icon="ri:rss-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a><a class="links-item hty-icon-button" href="/girls/" title="我永远喜欢oo" style="color:hotpink"><span class="icon iconify" data-icon="ri:women-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#section"><span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#windows-terminal"><span class="toc-text">Windows Terminal</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-text">配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#powershell-7"><span class="toc-text">PowerShell 7</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-1"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-1"><span class="toc-text">配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-gsudo"><span class="toc-text">安装 gsudo</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-oh-my-posh-3"><span class="toc-text">安装 Oh-My-Posh 3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-psreadline"><span class="toc-text">安装 PSReadLine</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-profile"><span class="toc-text">配置 Profile</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wsl"><span class="toc-text">WSL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-2"><span class="toc-text">安装</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-text">参考</span></a></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#66d6ff;"><link itemprop="mainEntityOfPage" href="http://lapras.xyz/2021/10/26/f77b55e6.html"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Anduin9527"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Anduin9527的乖离器"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">微软三件套安装以及配置</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="Created: 2021-10-26 17:27:59" itemprop="dateCreated datePublished" datetime="2021-10-26T17:27:59+08:00">2021-10-26</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="Modified: 2022-08-21 15:21:56" itemprop="dateModified" datetime="2022-08-21T15:21:56+08:00">2022-08-21</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="Word count in article">1.6k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="Reading time">6m</span></span></span><div class="post-classify"><span class="post-tag"><a class="tag-item" href="/tags/%E5%B7%A5%E5%85%B7/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">工具</span></a><a class="tag-item" href="/tags/%E5%88%86%E4%BA%AB/" style="--text-color:#0078e7"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">分享</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h3 id="section"><img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20211026174036.jpg" alt="cxdxhh2f9r071" style="zoom:50%;" / loading="lazy"></h3>
<span id="more"></span>
<h2 id="windows-terminal">Windows Terminal</h2>
<blockquote>
<p>Windows 终端是一个面向命令行工具和 shell（如命令提示符（cmd）、PowerShell 和适用于 Linux 的 Windows 子系统 (WSL)）用户的新式终端应用程序。 它的主要功能包括多个选项卡、窗格、Unicode 和 UTF-8 字符支持、GPU 加速文本呈现引擎，你还可用它来创建你自己的主题并自定义文本、颜色、背景和快捷方式。</p>
</blockquote>
<del>
好看才是第一生产力，所以别在用 cmd 的黑框还有 powershell 的蓝框了
</del>
<h3 id="安装">安装</h3>
<p>方法一 <a target="_blank" rel="noopener" href="https://aka.ms/terminal">微软商店</a>（推荐方式）</p>
<p>方法二 Windows Terminal 的 <a target="_blank" rel="noopener" href="https://github.com/microsoft/terminal/releases">Github Releases</a> <img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20211026175219.png" alt="image-20211026175219873" style="zoom:67%;" / loading="lazy"></p>
<ul>
<li>选择完版本（preview 是预览版），选择后缀为 <code>.msixbundle</code> 的文件下载安装即可</li>
</ul>
<p>方法三 winget</p>
<p>首先你得微软商店（搜索应用安装程序）通过 <a target="_blank" rel="noopener" href="https://github.com/microsoft/winget-cli/releases">Github Releases</a> 安装 winget，然后打开你的 powershell 输入</p>
<pre class="language-powershell" data-language="powershell"><code class="language-powershell">winget install <span class="token operator">--</span>id=Microsoft<span class="token punctuation">.</span>WindowsTerminal <span class="token operator">-</span>e
<span class="token comment">#安装成功后查看版本</span>
winget <span class="token operator">-</span>v</code></pre>
<ul>
<li><p>如果提示没有这个命令，考虑重启终端或者重启电脑</p></li>
<li><p>推荐安装一下，因为后续的 powershell7 配置（美化）还会用到这个东西</p></li>
</ul>
<p>安装成功之后</p>
<p><img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20211026180656.png" alt="image-20211026180655833" style="zoom: 50%;" / loading="lazy"></p>
<p><img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20211026180900.png" alt="image-20211026180900388" style="zoom: 50%;" / loading="lazy"></p>
<p>你会发现你的界面和我的不大一样，问题不大，下面开始配置</p>
<h3 id="配置">配置</h3>
<p>选择 <strong>设置</strong> 可以进行一些基础功能的设置，比较明了，不作介绍。所有的配置项都在 <code>setting.json</code>（点击设置后，选择打开 JSON 文件）中保存。</p>
<figure>
<img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20211026184621.png" alt="image-20211026184621095" / loading="lazy"><figcaption aria-hidden="true">image-20211026184621095</figcaption>
</figure>
<ul>
<li>最外层都是一些全局设置，具体的配置选项可以去 <a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/terminal/json-fragment-extensions">微软文档</a> 中看</li>
<li><code>defaultProfile</code>：值是一个 UUID，也就是 <code>profiles</code> 的 <code>guid</code></li>
<li><code>keybindings</code>：自定义一些快捷键</li>
<li><code>profiles</code> 的默认选项是对所有配置文件生效的
<ul>
<li><code>acrylicOpacity</code>：亚克力面板效果</li>
<li><code>fontFace</code>：选择安装含有 PL（powerline）且等宽（Mono）的字体（推荐 https://www.nerdfonts.com/font-downloads）</li>
<li><code>list</code>：含有众多配置的单独设置，如果你自己新建的话，注意 <code>guid</code> 别自己写。然后如果配置要连接你的服务器 <code>commandline</code> 就可以写成 ssh 之类的</li>
</ul></li>
<li><code>schemes</code>：配色方案</li>
</ul>
<h2 id="powershell-7">PowerShell 7</h2>
<blockquote>
<p>Windows PowerShell 5.1 是在 .NET Framework v4.5 基础上构建的。 随着 PowerShell 6.0 的发布，PowerShell 成为基于 .NET Core 2.0 构建的开源项目。 PowerShell 7.0 是在 .NET Core 3.1 基础上构建的。 随着 PowerShell 7.2 的发布，将在 .NET 6.0 基础上构建 PowerShell。 从 .NET Framework 转换到 .Net Core 使 PowerShell 成为可跨平台的解决方案。 PowerShell 在 Windows、macOS 和 Linux 上运行。</p>
</blockquote>
<h3 id="安装-1">安装</h3>
<p>方法一 微软商店 <del> 连 Powershell 都上了 VSCode 呢？</del></p>
<p>方法二 PowerShell 的 <a target="_blank" rel="noopener" href="https://github.com/PowerShell/PowerShell/releases/">Github Releases</a> windows 选择 <code>.msi</code> 后缀即可</p>
<p>方法三 winget</p>
<pre class="language-powershell" data-language="powershell"><code class="language-powershell">winget install <span class="token operator">--</span>name PowerShell <span class="token operator">--</span>exact <span class="token operator">--</span>source winget</code></pre>
<h3 id="配置-1">配置</h3>
<p>首先是要让之前安装的 windows terminal 默认开启 powershell 7 而不是原装的 windows powershell</p>
<p>打开之前的 <code>Profile</code> 在如下位置添加 <code>commandline</code></p>
<pre class="language-json" data-language="json"><code class="language-json"><span class="token property">"profiles"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"defaults"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"commandline"</span><span class="token operator">:</span> <span class="token string">"pwsh.exe"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span></code></pre>
<h4 id="安装-gsudo">安装 gsudo</h4>
<p>在命令行中提供管理员权限，而无需另起管理员 powershell</p>
<pre class="language-powershell" data-language="powershell"><code class="language-powershell">winget install <span class="token operator">--</span>name gsudo <span class="token operator">--</span>source winget
<span class="token comment">#安装成功后查看版本</span>
sudo <span class="token operator">-</span>v
<span class="token comment">#使用</span>
sudo yourcommand</code></pre>
<ul>
<li>后续的命令中有一些需要管理员权限</li>
</ul>
<h4 id="安装-oh-my-posh-3">安装 Oh-My-Posh 3</h4>
<p>有的人应该知道 oh-my-zsh，都是懒癌福音，一键解锁终端主题。</p>
<pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">Install-Module</span> oh-my-posh <span class="token operator">-</span>Scope AllUsers</code></pre>
<p>安装中基本一直 y 即可</p>
<p>安装完成之后，可以查看现有的主题，然后选择一个更换。</p>
<pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment">#查看主题</span>
<span class="token function">Get-PoshThemes</span>						
<span class="token comment">#设置主题</span>
<span class="token function">Set-PoshPrompt</span> <span class="token operator">-</span>Theme ThemeName</code></pre>
<ul>
<li>如果你发现主题中有大量方框乱码，请回到上文考虑修改默认字体</li>
</ul>
<p>当然如果你想要自定义主题的话可以导出主题配置文件，然后修改其 json 文件再重新设置</p>
<pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment">#导出主题</span>
<span class="token function">Export-PoshTheme</span> <span class="token operator">-</span>FilePath ~<span class="token operator">/</span><span class="token punctuation">.</span>mytheme<span class="token punctuation">.</span>omp<span class="token punctuation">.</span>json
<span class="token comment">#设置主题</span>
<span class="token function">Set-PoshPrompt</span> <span class="token operator">-</span>Theme ~<span class="token operator">/</span><span class="token punctuation">.</span>mytheme<span class="token punctuation">.</span>omp<span class="token punctuation">.</span>json</code></pre>
<p>但是你会发现重启终端之后就失效了，这是为什么嘞？，其实是要修改 PowerShell 自身的配置文件（类似于.zshrc 或者.bashrc）。</p>
<h4 id="安装-psreadline">安装 PSReadLine</h4>
<p>PSReadLine 会根据你的历史记录来进行预测和补全命令</p>
<pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">Install-Module</span> PSReadLine <span class="token operator">-</span>Scope AllUsers</code></pre>
<pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment"># 显示所有可以配置的选项</span>
<span class="token function">Get-PSReadLineOption</span>  
<span class="token comment"># 显示所有可以配置的快捷键</span>
<span class="token function">Get-PSReadLineKeyHandler</span>  </code></pre>
<h4 id="配置-profile">配置 Profile</h4>
<pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">Test-Path</span> <span class="token operator">-</span>Path <span class="token variable">$PROFILE</span><span class="token punctuation">.</span>AllUsersCurrentHost<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">New-Item</span> <span class="token operator">-</span>ItemType File <span class="token operator">-</span>Path <span class="token variable">$PROFILE</span><span class="token punctuation">.</span>AllUsersCurrentHost <span class="token operator">-</span>Force
<span class="token punctuation">&#125;</span></code></pre>
<ul>
<li>一个简单的脚本判断你是否已经创建了配置文件</li>
</ul>
<pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment">#使用vscode编辑</span>
code <span class="token variable">$Profile</span> 
<span class="token comment">#使用记事本编辑 （呜呜呜别再用记事本了）</span>
notepad <span class="token variable">$Profile</span></code></pre>
<p>在 <code>$Profile</code> 中添加：</p>
<pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment"># 设置 oh-my-posh</span>
<span class="token function">Import-Module</span> oh-my-posh
<span class="token comment"># 设置 ps-read-line</span>
<span class="token function">Import-Module</span> PSReadLine
<span class="token comment"># 设置主题</span>
<span class="token function">Set-PoshPrompt</span> paradox
<span class="token comment"># 设置预测文本来源为历史记录</span>
<span class="token function">Set-PSReadLineOption</span> <span class="token operator">-</span>PredictionSource History
<span class="token comment"># 每次回溯输入历史，光标定位于输入内容末尾</span>
<span class="token function">Set-PSReadLineOption</span> <span class="token operator">-</span>HistorySearchCursorMovesToEnd
<span class="token comment"># 设置 Tab 为菜单补全和 Intellisense</span>
<span class="token function">Set-PSReadLineKeyHandler</span> <span class="token operator">-</span>Key <span class="token string">"Tab"</span> <span class="token operator">-</span><span class="token keyword">Function</span> MenuComplete
<span class="token comment"># 设置向上键为后向搜索历史记录</span>
<span class="token function">Set-PSReadLineKeyHandler</span> <span class="token operator">-</span>Key UpArrow <span class="token operator">-</span><span class="token keyword">Function</span> HistorySearchBackward
<span class="token comment"># 设置向下键为前向搜索历史纪录</span>
<span class="token function">Set-PSReadLineKeyHandler</span> <span class="token operator">-</span>Key DownArrow <span class="token operator">-</span><span class="token keyword">Function</span> HistorySearchForward</code></pre>
<p>最后重启终端即可！</p>
<h2 id="wsl">WSL</h2>
<blockquote>
<p>适用于 Linux 的 Windows 子系统可让开发人员按原样运行 GNU/Linux 环境 - 包括大多数命令行工具、实用工具和应用程序 - 且不会产生传统虚拟机或双启动设置开销。</p>
<p>您可以：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://aka.ms/wslstore">在 Microsoft Store</a> 中选择你偏好的 GNU/Linux 分发版。</li>
<li>运行常用的命令行软件工具（例如 <code>grep</code>、<code>sed</code>、<code>awk</code>）或其他 ELF-64 二进制文件。</li>
<li>运行 Bash shell 脚本和 GNU/Linux 命令行应用程序，包括：</li>
<li>工具：vim、emacs、tmux</li>
<li>语言：<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/nodejs/setup-on-wsl2">NodeJS</a>、Javascript、<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/python/web-frameworks">Python</a>、Ruby、C/ C++、C# 与 F#、Rust、Go 等。</li>
<li>服务：SSHD、<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/wsl/tutorials/wsl-database">MySQL</a>、Apache、lighttpd、<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/wsl/tutorials/wsl-database">MongoDB</a>、<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/wsl/tutorials/wsl-database">PostgreSQL</a>。</li>
<li>使用自己的 GNU/Linux 分发包管理器安装其他软件。</li>
<li>使用类似于 Unix 的命令行 shell 调用 Windows 应用程序。</li>
<li>在 Windows 上调用 GNU/Linux 应用程序。</li>
<li>现已支持 CUDA！一起来炼丹吧！</li>
</ul>
</blockquote>
<h3 id="安装-2">安装</h3>
<pre class="language-powershell" data-language="powershell"><code class="language-powershell">wsl <span class="token operator">--</span>install</code></pre>
<ul>
<li>此命令将启用所需的可选组件，下载最新的 Linux 内核，将 WSL 2 设置为默认值，并默认安装 Ubuntu</li>
<li>而后会新建用户并设置密码</li>
</ul>
<p>然后重启电脑。在终端就看见一个新的选项卡</p>
<p>而后的 Linux 配置可以参考组内另一名讲师（莫非）的 <a target="_blank" rel="noopener" href="https://closed-linen-ea9.notion.site/Ubuntu-cb4d33bdbcc2400b9b04cc56ba21d080">虚拟机安装 Ubuntu 教程</a></p>
<h2 id="参考">参考</h2>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/">微软官方文档</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/137595941">Windows Terminal 完美配置 PowerShell 7.1</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/351281543">Window Terminal 安装以及使用</a></p>
</div></section><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>Anduin9527</li><li class="post-copyright-link"><strong>Post link: </strong><a href="http://lapras.xyz/2021/10/26/f77b55e6.html" title="微软三件套安装以及配置">http://lapras.xyz/2021/10/26/f77b55e6.html</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> unless otherwise stated.</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/12/01/e7c345c1.html" rel="prev" title="数据结构期末复习"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">数据结构期末复习</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/10/24/db7ea760.html" rel="next" title="搜索算法小整理（上）"><span class="post-nav-text">搜索算法小整理（上）</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>如果您有任何关于博客内容的相关讨论，欢迎与我交流。</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">闽ICP备2021012704号</a></div><div class="copyright"><span>&copy; 2020 – 2022 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> Anduin9527</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v6.2.0</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.6</span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#66d6ff" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" target="_blank" rel="noopener" href="https://www.google.com/search?q=site:lapras.xyz" title="Search"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>function initMourn() {
  const date = new Date();
  const today = (date.getMonth() + 1) + "-" + date.getDate()
  const mourn_days = ["4-4","9-18","5-12","12-13"]
  if (mourn_days.includes(today)) {
    document.documentElement.style.filter = "grayscale(1)";
  }
}
initMourn();</script></body></html>